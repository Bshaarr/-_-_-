<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>منصة موروكس التعليمية - نظام إدارة التعلم المتكامل</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        
        * {
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .robot-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .certificate-bg {
            background: linear-gradient(45deg, #f3ec78, #af4261);
        }
        
        .admin-panel {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            min-height: 100vh;
        }
        
        .admin-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .certificate-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 8px solid #ffd700;
            position: relative;
            overflow: hidden;
        }
        
        .certificate-template::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
        }
        
        .certificate-seal {
            position: absolute;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }
        
        .stats-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.1) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.15) 100%);
        }
        
        .admin-nav-btn {
            transition: all 0.3s ease;
        }
        
        .admin-nav-btn:hover {
            background: rgba(255,255,255,0.2) !important;
            color: white !important;
        }
        
        .admin-nav-btn.active {
            background: rgba(255,255,255,0.2) !important;
            color: white !important;
        }
        
        .form-input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
        }
        
        .form-input::placeholder {
            color: rgba(255,255,255,0.7);
        }
        
        .form-input:focus {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.4);
            outline: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            transition: all 0.3s ease;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(5px);
            background: rgba(0,0,0,0.5);
        }
        
        .course-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .course-card:hover {
            transform: translateY(-5px);
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.1) 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="notifications" class="fixed top-4 left-4 z-50 space-y-2"></div>

    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <div class="robot-animation text-6xl mb-4">🤖</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-3">مرحباً بك في موروكس</h1>
                <p class="text-gray-600">منصة تدريب مهارات الذكاء الاصطناعي</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">الاسم الكامل</label>
                    <input type="text" id="studentName" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل اسمك الكامل">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">رقم الهاتف</label>
                    <input type="tel" id="studentPhone" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل رقم هاتفك">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">البريد الإلكتروني</label>
                    <input type="email" id="studentEmail" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل بريدك الإلكتروني">
                </div>
                
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-lg font-semibold hover:shadow-lg transition-all text-lg">
                    دخول المنصة
                </button>
            </form>

            <div class="mt-6 pt-6 border-t border-gray-200">
                <button type="button" onclick="showAdminLogin()"
                        class="w-full bg-gradient-to-r from-red-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                    <i class="fas fa-user-shield mr-2"></i>دخول المدير
                </button>
            </div>
        </div>
    </div>

    <div id="adminLoginModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-6">
                <div class="text-5xl mb-4">🛡️</div>
                <h2 class="text-2xl font-bold text-gray-800">دخول المدير</h2>
            </div>
            
            <form id="adminLoginForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">اسم المستخدم</label>
                    <input type="text" id="adminUsername" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"
                           placeholder="Bashar">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">كلمة المرور</label>
                    <input type="password" id="adminPassword" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"
                           placeholder="bbsshhaarr6405">
                </div>
                
                <div class="flex space-x-3 space-x-reverse">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-red-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                        دخول
                    </button>
                    <button type="button" onclick="hideAdminLogin()"
                            class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="mainWebsite" class="hidden">
        <header class="bg-white shadow-lg sticky top-0 z-40">
            <div class="px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <div class="text-3xl">🤖</div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800">موروكس</h1>
                            <p class="text-sm text-gray-600">منصة تدريب الذكاء الاصطناعي</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <span class="text-sm text-gray-600">مرحباً، <span id="welcomeName" class="font-semibold text-blue-600"></span></span>
                        <button onclick="logout()" class="text-gray-600 hover:text-red-600 p-2 transition-colors">
                            <i class="fas fa-sign-out-alt text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <nav class="bg-gray-100 border-b border-gray-200">
            <div class="px-4 py-3">
                <div class="flex space-x-1 space-x-reverse overflow-x-auto">
                    <button onclick="showSection('dashboard')" class="nav-btn bg-blue-50 text-blue-600 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-home mr-2"></i>الرئيسية
                    </button>
                    <button onclick="showSection('courses')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-book mr-2"></i>الدورات
                    </button>
                    <button onclick="showSection('quiz')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-question-circle mr-2"></i>الاختبارات
                    </button>
                    <button onclick="showSection('certificates')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-certificate mr-2"></i>الشهادات
                    </button>
                </div>
            </div>
        </nav>

        <section id="dashboardSection" class="py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-8 rounded-2xl text-center mb-8 card-hover">
                    <div class="text-5xl mb-4">🎉</div>
                    <h2 class="text-3xl font-bold mb-3">مرحباً بك <span id="welcomeName2" class="text-yellow-300"></span>!</h2>
                    <p class="text-lg opacity-90 mb-6">في منصة موروكس لتدريب مهارات الذكاء الاصطناعي</p>
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div>
                            <div class="text-2xl font-bold">12+</div>
                            <div class="text-sm opacity-80">دورة تدريبية</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold">500+</div>
                            <div class="text-sm opacity-80">طالب مسجل</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold">95%</div>
                            <div class="text-sm opacity-80">معدل النجاح</div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <button onclick="showSection('courses')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-blue-500">
                        <div class="text-4xl mb-4 text-blue-500">📚</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">تصفح الدورات</h3>
                        <p class="text-gray-600">اكتشف دورات جديدة في الذكاء الاصطناعي</p>
                    </button>
                    
                    <button onclick="showSection('quiz')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-green-500">
                        <div class="text-4xl mb-4 text-green-500">🧠</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">اختبر معلوماتك</h3>
                        <p class="text-gray-600">اختبارات تفاعلية ومتنوعة</p>
                    </button>
                    
                    <button onclick="showSection('certificates')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-yellow-500">
                        <div class="text-4xl mb-4 text-yellow-500">🏆</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">احصل على شهادة</h3>
                        <p class="text-gray-600">شهادات معتمدة لإنجازاتك</p>
                    </button>
                </div>
            </div>
        </section>

        <section id="coursesSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">الدورات التدريبية</h2>
                    <p class="text-xl text-gray-600">اختر من مجموعة متنوعة من دورات الذكاء الاصطناعي</p>
                </div>
                
                <div id="coursesList" class="grid gap-8">
                    </div>
            </div>
        </section>

        <section id="quizSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">الاختبارات التفاعلية</h2>
                    <p class="text-xl text-gray-600">اختبر معلوماتك في مجال الذكاء الاصطناعي</p>
                </div>
                
                <div class="grid gap-8">
                    <div class="bg-white p-8 rounded-2xl shadow-lg card-hover">
                        <div class="flex items-center mb-6">
                            <div class="text-5xl mr-6">🧠</div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800">اختبار أساسيات الذكاء الاصطناعي</h3>
                                <p class="text-gray-600 text-lg">اختبار شامل حول المفاهيم الأساسية</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="text-gray-500 space-x-4 space-x-reverse">
                                <span class="inline-flex items-center"><i class="fas fa-clock mr-2"></i>15 دقيقة</span>
                                <span class="inline-flex items-center"><i class="fas fa-question-circle mr-2"></i>10 أسئلة</span>
                                <span class="inline-flex items-center"><i class="fas fa-star mr-2"></i>100 نقطة</span>
                            </div>
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold transition-all">
                                ابدأ الاختبار
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white p-8 rounded-2xl shadow-lg card-hover">
                        <div class="flex items-center mb-6">
                            <div class="text-5xl mr-6">🤖</div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800">اختبار التعلم الآلي</h3>
                                <p class="text-gray-600 text-lg">اختبار متقدم في مجال التعلم الآلي</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="text-gray-500 space-x-4 space-x-reverse">
                                <span class="inline-flex items-center"><i class="fas fa-clock mr-2"></i>20 دقيقة</span>
                                <span class="inline-flex items-center"><i class="fas fa-question-circle mr-2"></i>15 أسئلة</span>
                                <span class="inline-flex items-center"><i class="fas fa-star mr-2"></i>150 نقطة</span>
                            </div>
                            <button class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg font-semibold transition-all">
                                ابدأ الاختبار
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="certificatesSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">الشهادات</h2>
                    <p class="text-xl text-gray-600">احصل على شهادات معتمدة لإنجازاتك</p>
                </div>
                
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">طلب شهادة للدورات المسجل بها</h3>
                    <div id="availableCertificates" class="grid gap-6">
                        </div>
                </div>
                
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">شهاداتي المعتمدة</h3>
                    <div id="userApprovedCertificates" class="grid gap-6">
                        </div>
                </div>
                
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">الطلبات المعلقة</h3>
                    <div id="pendingCertificatesList">
                        </div>
                </div>
            </div>
        </section>

        <footer class="bg-gray-800 text-white py-12">
            <div class="container mx-auto px-4 max-w-6xl">
                <div class="text-center mb-8">
                    <div class="text-4xl mb-4">🤖</div>
                    <h4 class="text-2xl font-bold mb-4">منصة موروكس التعليمية</h4>
                    <p class="text-gray-400 text-lg mb-6">تدريب مهارات الذكاء الاصطناعي بأسلوب ممتع وبسيط</p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-8 mb-8">
                    <div>
                        <h5 class="font-bold text-lg mb-4">روابط سريعة</h5>
                        <ul class="space-y-3 text-gray-400">
                            <li><a href="#" onclick="showSection('courses')" class="hover:text-white transition-colors">الدورات</a></li>
                            <li><a href="#" onclick="showSection('quiz')" class="hover:text-white transition-colors">الاختبارات</a></li>
                            <li><a href="#" onclick="showSection('certificates')" class="hover:text-white transition-colors">الشهادات</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-lg mb-4">تواصل معنا</h5>
                        <div class="space-y-3">
                            <a href="https://www.facebook.com/share/1GmdvSKcuU/" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-facebook mr-3 text-xl"></i>فيسبوك
                            </a>
                            <a href="https://www.instagram.com/morox732?igsh=ajBlbW1jdHpweTdu" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-instagram mr-3 text-xl"></i>إنستغرام
                            </a>
                            <a href="https://youtube.com/@morox732?si=IXRA6Jv8ut7L5Bvb" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-youtube mr-3 text-xl"></i>يوتيوب
                            </a>
                            <a href="https://chat.whatsapp.com/FJnj4j3bMhJ15d7XhUBmgl?mode=ac_t" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-whatsapp mr-3 text-xl"></i>واتساب
                            </a>
                        </div>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-lg mb-4">معلومات المنصة</h5>
                        <p class="text-gray-400">منصة موروكس هي منصة تعليمية متخصصة في تدريب مهارات الذكاء الاصطناعي للطلاب والمهنيين.</p>
                    </div>
                </div>
                
                <div class="text-center pt-8 border-t border-gray-700">
                    <p class="text-gray-500">© 2024 منصة موروكس التعليمية. جميع الحقوق محفوظة.</p>
                    <p class="text-gray-400 mt-2">تحت إشراف: م. بشار عنيزان</p>
                </div>
            </div>
        </footer>
    </div>

    <div id="adminPanel" class="hidden admin-panel">
        <header class="bg-white/10 backdrop-blur-md border-b border-white/20 sticky top-0 z-40">
            <div class="px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="text-3xl">🛡️</div>
                        <div>
                            <h1 class="text-xl font-bold text-white">لوحة تحكم المدير</h1>
                            <p class="text-sm text-white/70">م. بشار عنيزان - مدير المنصة</p>
                        </div>
                    </div>
                    
                    <button onclick="logoutAdmin()" class="text-white/70 hover:text-white p-3 rounded-lg transition-colors">
                        <i class="fas fa-sign-out-alt text-xl"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="px-6 py-8">
            <div class="mb-8">
                <div class="flex space-x-2 space-x-reverse overflow-x-auto pb-2">
                    <button onclick="showAdminSection('stats')" class="admin-nav-btn active px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-chart-bar mr-2"></i>الإحصائيات
                    </button>
                    <button onclick="showAdminSection('courses')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-book mr-2"></i>إدارة الدورات
                    </button>
                    <button onclick="showAdminSection('announcements')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-bullhorn mr-2"></i>الإعلانات
                    </button>
                    <button onclick="showAdminSection('certificates')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-certificate mr-2"></i>الشهادات
                    </button>
                    <button onclick="showAdminSection('users')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-users mr-2"></i>المستخدمين
                    </button>
                </div>
            </div>

            <div id="adminStatsSection" class="admin-section">
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">إجمالي المستخدمين</p>
                                <p class="text-3xl font-bold" id="totalUsersCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">👥</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">التسجيلات</p>
                                <p class="text-3xl font-bold" id="totalRegistrationsCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">📝</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">طلبات الشهادات</p>
                                <p class="text-3xl font-bold" id="pendingCertificatesCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">⏳</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">الشهادات المصدرة</p>
                                <p class="text-3xl font-bold" id="totalCertificatesCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">🏆</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="adminCoursesSection" class="admin-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">إدارة الدورات</h3>
                    <button onclick="showAddCourseModal()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-plus mr-2"></i>إضافة دورة جديدة
                    </button>
                </div>
                
                <div id="adminCoursesList" class="grid gap-6">
                    </div>
            </div>

            <div id="adminAnnouncementsSection" class="admin-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">إدارة الإعلانات</h3>
                    <button onclick="showAddAnnouncementModal()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-plus mr-2"></i>إضافة إعلان جديد
                    </button>
                </div>
                
                <div id="adminAnnouncementsList" class="grid gap-6">
                    </div>
            </div>

            <div id="adminCertificatesSection" class="admin-section hidden">
                <div class="admin-card rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-white mb-4">إدارة الشهادات</h3>
                    
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-white mb-3">طلبات الشهادات المعلقة</h4>
                        <div id="pendingCertificatesAdmin" class="space-y-3">
                            </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-3">الشهادات المعتمدة</h4>
                        <div id="approvedCertificatesAdmin" class="space-y-3">
                            </div>
                    </div>
                </div>
            </div>

            <div id="adminUsersSection" class="admin-section hidden">
                <div class="admin-card rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">إدارة المستخدمين</h3>
                    <div id="usersList" class="space-y-3">
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div id="addCourseModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-gray-800">إضافة دورة جديدة</h2>
                <button onclick="hideAddCourseModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="addCourseForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">عنوان الدورة</label>
                    <input type="text" id="courseTitle" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل عنوان الدورة">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">وصف الدورة</label>
                    <textarea id="courseDescription" required rows="3"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                              placeholder="أدخل وصف الدورة"></textarea>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">اسم المدرب</label>
                    <input type="text" id="courseInstructor" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل اسم المدرب">
                </div>
                
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">عدد الدروس</label>
                        <input type="number" id="courseLessons" required min="1"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="12">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">عدد الساعات</label>
                        <input type="number" id="courseHours" required min="1"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="8">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">السعر (ريال)</label>
                        <input type="number" id="coursePrice" required min="0"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="299">
                    </div>
                </div>
                
                <div class="flex space-x-3 space-x-reverse pt-4">
                    <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-semibold">
                        إضافة الدورة
                    </button>
                    <button type="button" onclick="hideAddCourseModal()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold">
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="addAnnouncementModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-gray-800">إضافة إعلان جديد</h2>
                <button onclick="hideAddAnnouncementModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="addAnnouncementForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">عنوان الإعلان</label>
                    <input type="text" id="announcementTitle" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="أدخل عنوان الإعلان">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">محتوى الإعلان</label>
                    <textarea id="announcementContent" required rows="4"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                              placeholder="أدخل محتوى الإعلان"></textarea>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">نوع الإعلان</label>
                    <select id="announcementType" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        <option value="info">معلومات عامة</option>
                        <option value="success">إنجاز أو نجاح</option>
                        <option value="warning">تحذير أو تنبيه</option>
                        <option value="error">خطأ أو مشكلة</option>
                    </select>
                </div>
                
                <div class="flex space-x-3 space-x-reverse pt-4">
                    <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-semibold">
                        إضافة الإعلان
                    </button>
                    <button type="button" onclick="hideAddAnnouncementModal()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold">
                        إلغاء
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBT4YJcnZZmUhKVvs7iMp5mdAeWRjixEfI",
            authDomain: "platform-fd979.firebaseapp.com",
            projectId: "platform-fd979",
            storageBucket: "platform-fd979.firebasestorage.app",
            messagingSenderId: "184754007748",
            appId: "1:184754007748:web:a849462d9cb2bdb3a6e391",
            measurementId: "G-9FB64YHKM3"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // Global Variables
        let currentUser = null;
        let isAdmin = false;
        
        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            notification.className = `notification ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg max-w-sm`;
            notification.textContent = message;
            const container = document.getElementById('notifications');
            container.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }
        
        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            const sections = ['dashboardSection', 'coursesSection', 'quizSection', 'certificatesSection'];
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) element.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation buttons - find the clicked button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'text-blue-600');
                btn.classList.add('text-gray-700', 'hover:bg-gray-200');
            });
            
            // Find and highlight the correct button based on section name
            const buttonMap = {
                'dashboard': 0,
                'courses': 1,
                'quiz': 2,
                'certificates': 3
            };
            const buttons = document.querySelectorAll('.nav-btn');
            const activeButtonIndex = buttonMap[sectionName];
            if (buttons[activeButtonIndex]) {
                buttons[activeButtonIndex].classList.remove('text-gray-700', 'hover:bg-gray-200');
                buttons[activeButtonIndex].classList.add('bg-blue-50', 'text-blue-600');
            }
            
            // Load section-specific data
            if (sectionName === 'courses') {
                loadCourses();
            } else if (sectionName === 'certificates') {
                loadUserCertificates();
            }
        }
        
        function showAdminSection(sectionName) {
            // Hide all admin sections
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            const targetSection = document.getElementById('admin' + sectionName.charAt(0).toUpperCase() + sectionName.slice(1) + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation buttons
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-white/20');
                btn.classList.add('text-white/70');
            });
            
            // Add active class to the current button
            const clickedBtn = event.target.closest('.admin-nav-btn');
            if (clickedBtn) {
                clickedBtn.classList.add('active');
                clickedBtn.classList.remove('text-white/70');
            }
            
            // Load section-specific data
            if (sectionName === 'stats') {
                loadStats();
            } else if (sectionName === 'courses') {
                loadAdminCourses();
            } else if (sectionName === 'announcements') {
                loadAnnouncements();
            } else if (sectionName === 'certificates') {
                loadAdminCertificates();
            } else if (sectionName === 'users') {
                loadUsers();
            }
        }
        
        // Admin Management Modals
        function showAddCourseModal() {
            document.getElementById('addCourseModal').classList.remove('hidden');
        }
        
        function hideAddCourseModal() {
            document.getElementById('addCourseModal').classList.add('hidden');
        }
        
        function showAddAnnouncementModal() {
            document.getElementById('addAnnouncementModal').classList.remove('hidden');
        }
        
        function hideAddAnnouncementModal() {
            document.getElementById('addAnnouncementModal').classList.add('hidden');
        }
        
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
        }
        
        function hideAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
        }
        
        // Authentication Functions
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const studentName = document.getElementById('studentName').value;
            const studentEmail = document.getElementById('studentEmail').value;
            const studentPhone = document.getElementById('studentPhone').value;
            
            try {
                const docRef = db.collection('users').doc(studentEmail);
                const doc = await docRef.get();
                
                if (doc.exists) {
                    // User exists, sign in
                    const userData = doc.data();
                    const userCredential = await auth.signInWithEmailAndPassword(studentEmail, userData.password); // Assuming password field exists
                    currentUser = userCredential.user;
                } else {
                    // New user, register
                    const tempPassword = studentPhone; // Use phone number as temporary password
                    const userCredential = await auth.createUserWithEmailAndPassword(studentEmail, tempPassword);
                    currentUser = userCredential.user;
                    
                    // Add user to Firestore
                    await docRef.set({
                        name: studentName,
                        phone: studentPhone,
                        email: studentEmail,
                        role: 'user', // Default role
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                // Set custom claims for new users (requires server-side function)
                // This part would be handled by a Cloud Function for production
                
                showNotification(`مرحباً بك ${studentName}! تم تسجيل الدخول بنجاح`, 'success');
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainWebsite').classList.remove('hidden');
                document.getElementById('welcomeName').textContent = studentName;
                document.getElementById('welcomeName2').textContent = studentName;
                showSection('dashboard');
                
            } catch (error) {
                console.error("Error signing in or registering:", error);
                showNotification("فشل تسجيل الدخول. يرجى التحقق من بياناتك.", 'error');
            }
        });
        
        document.getElementById('adminLoginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            try {
                if (username === 'Bashar' && password === 'bbsshhaarr6405') {
                    // Dummy admin login for development
                    // In a real app, this should be handled by Firebase Authentication
                    // with a dedicated admin account and custom claims.
                    showNotification('تم تسجيل الدخول كمدير', 'success');
                    isAdmin = true;
                    document.getElementById('adminLoginModal').classList.add('hidden');
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    showAdminSection('stats');
                } else {
                    showNotification('بيانات الدخول غير صحيحة.', 'error');
                }
            } catch (error) {
                console.error("Admin login error:", error);
                showNotification("فشل تسجيل الدخول.", 'error');
            }
        });
        
        function logout() {
            auth.signOut().then(() => {
                showNotification('تم تسجيل الخروج بنجاح', 'info');
                document.getElementById('mainWebsite').classList.add('hidden');
                document.getElementById('adminPanel').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
            }).catch((error) => {
                console.error("Logout error:", error);
                showNotification('فشل تسجيل الخروج.', 'error');
            });
        }
        
        function logoutAdmin() {
            logout();
        }
        
        // Course Management
        document.getElementById('addCourseForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const title = document.getElementById('courseTitle').value;
            const description = document.getElementById('courseDescription').value;
            const instructor = document.getElementById('courseInstructor').value;
            const lessons = document.getElementById('courseLessons').value;
            const hours = document.getElementById('courseHours').value;
            const price = document.getElementById('coursePrice').value;
            
            try {
                await db.collection('courses').add({
                    title,
                    description,
                    instructor,
                    lessons: Number(lessons),
                    hours: Number(hours),
                    price: Number(price),
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                showNotification('تم إضافة الدورة بنجاح!', 'success');
                hideAddCourseModal();
                document.getElementById('addCourseForm').reset();
            } catch (error) {
                console.error("Error adding course:", error);
                showNotification('فشل إضافة الدورة.', 'error');
            }
        });
        
        // Announcement Management
        document.getElementById('addAnnouncementForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const title = document.getElementById('announcementTitle').value;
            const content = document.getElementById('announcementContent').value;
            const type = document.getElementById('announcementType').value;
            
            try {
                await db.collection('announcements').add({
                    title,
                    content,
                    type,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                showNotification('تم إضافة الإعلان بنجاح!', 'success');
                hideAddAnnouncementModal();
                document.getElementById('addAnnouncementForm').reset();
            } catch (error) {
                console.error("Error adding announcement:", error);
                showNotification('فشل إضافة الإعلان.', 'error');
            }
        });
        
        // Load data functions
        function loadCourses() {
            db.collection('courses').orderBy('createdAt', 'desc')
                .onSnapshot(snap => {
                    const list = document.getElementById('coursesList');
                    list.innerHTML = '';
                    if (snap.empty) {
                        list.innerHTML = '<p class="text-center text-gray-500 text-lg">لا توجد دورات متاحة حالياً.</p>';
                        return;
                    }
                    snap.forEach(doc => {
                        const course = doc.data();
                        const courseCard = `
                            <div class="course-card rounded-2xl p-6 shadow-lg flex items-center justify-between">
                                <div class="flex-1">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-2">${course.title}</h3>
                                    <p class="text-gray-600 mb-4">${course.description}</p>
                                    <div class="flex items-center space-x-4 space-x-reverse text-sm text-gray-500">
                                        <span><i class="fas fa-chalkboard-teacher mr-2"></i>${course.instructor}</span>
                                        <span><i class="fas fa-book-open mr-2"></i>${course.lessons} درس</span>
                                        <span><i class="fas fa-clock mr-2"></i>${course.hours} ساعة</span>
                                        <span><i class="fas fa-dollar-sign mr-2"></i>${course.price} ريال</span>
                                    </div>
                                </div>
                                <div>
                                    <button class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-all">
                                        التسجيل
                                    </button>
                                </div>
                            </div>
                        `;
                        list.innerHTML += courseCard;
                    });
                });
        }
        
        function loadUserCertificates() {
            // This is a placeholder. A real implementation would query user-specific certificates.
            const approvedList = document.getElementById('userApprovedCertificates');
            const pendingList = document.getElementById('pendingCertificatesList');
            
            approvedList.innerHTML = '<p class="text-center text-gray-500 text-lg">لا توجد شهادات معتمدة حالياً.</p>';
            pendingList.innerHTML = '<p class="text-center text-gray-500 text-lg">لا توجد طلبات معلقة حالياً.</p>';
        }
        
        function loadStats() {
            // Placeholder functions for stats
            db.collection('users').get().then(snap => {
                document.getElementById('totalUsersCount').textContent = snap.size;
            });
            db.collection('registrations').get().then(snap => {
                document.getElementById('totalRegistrationsCount').textContent = snap.size;
            });
            db.collection('certificates').where('status', '==', 'pending').get().then(snap => {
                document.getElementById('pendingCertificatesCount').textContent = snap.size;
            });
            db.collection('certificates').where('status', '==', 'approved').get().then(snap => {
                document.getElementById('totalCertificatesCount').textContent = snap.size;
            });
        }
        
        function loadAdminCourses() {
            // Admin version of loading courses with management options
            db.collection('courses').orderBy('createdAt', 'desc')
                .onSnapshot(snap => {
                    const list = document.getElementById('adminCoursesList');
                    list.innerHTML = '';
                    if (snap.empty) {
                        list.innerHTML = '<p class="text-center text-white/70 text-lg">لا توجد دورات حالياً.</p>';
                        return;
                    }
                    snap.forEach(doc => {
                        const course = doc.data();
                        const courseDocId = doc.id;
                        const courseCard = `
                            <div class="admin-card rounded-xl p-6 flex items-center justify-between text-white">
                                <div class="flex-1">
                                    <h4 class="text-xl font-bold">${course.title}</h4>
                                    <p class="text-white/70 text-sm">${course.instructor}</p>
                                </div>
                                <div class="flex space-x-2 space-x-reverse">
                                    <button onclick="editCourse('${courseDocId}')" class="btn-warning p-2 rounded-full text-white"><i class="fas fa-edit"></i></button>
                                    <button onclick="deleteCourse('${courseDocId}')" class="btn-danger p-2 rounded-full text-white"><i class="fas fa-trash-alt"></i></button>
                                </div>
                            </div>
                        `;
                        list.innerHTML += courseCard;
                    });
                });
        }
        
        function editCourse(courseId) {
            showNotification(`تعديل الدورة: ${courseId}`, 'warning');
            // Implement edit logic
        }
        
        function deleteCourse(courseId) {
            if (confirm('هل أنت متأكد من حذف هذه الدورة؟')) {
                db.collection('courses').doc(courseId).delete()
                    .then(() => showNotification('تم حذف الدورة بنجاح.', 'success'))
                    .catch(err => showNotification('فشل حذف الدورة.', 'error'));
            }
        }
        
        function loadAnnouncements() {
            db.collection('announcements').orderBy('createdAt', 'desc')
                .onSnapshot(snap => {
                    const list = document.getElementById('adminAnnouncementsList');
                    list.innerHTML = '';
                    if (snap.empty) {
                        list.innerHTML = '<p class="text-center text-white/70 text-lg">لا توجد إعلانات حالياً.</p>';
                        return;
                    }
                    snap.forEach(doc => {
                        const announcement = doc.data();
                        const announcementDocId = doc.id;
                        const colors = {
                            info: 'bg-blue-500',
                            success: 'bg-green-500',
                            warning: 'bg-yellow-500',
                            error: 'bg-red-500'
                        };
                        const announcementCard = `
                            <div class="admin-card rounded-xl p-6 flex items-center justify-between text-white ${colors[announcement.type]}">
                                <div class="flex-1">
                                    <h4 class="text-xl font-bold">${announcement.title}</h4>
                                    <p class="text-sm">${announcement.content}</p>
                                </div>
                                <button onclick="deleteAnnouncement('${announcementDocId}')" class="btn-danger p-2 rounded-full text-white"><i class="fas fa-trash-alt"></i></button>
                            </div>
                        `;
                        list.innerHTML += announcementCard;
                    });
                });
        }
        
        function deleteAnnouncement(announcementId) {
            if (confirm('هل أنت متأكد من حذف هذا الإعلان؟')) {
                db.collection('announcements').doc(announcementId).delete()
                    .then(() => showNotification('تم حذف الإعلان بنجاح.', 'success'))
                    .catch(err => showNotification('فشل حذف الإعلان.', 'error'));
            }
        }
        
        function loadAdminCertificates() {
            // Admin version of certificate management
            const pendingList = document.getElementById('pendingCertificatesAdmin');
            const approvedList = document.getElementById('approvedCertificatesAdmin');
            
            pendingList.innerHTML = '<p class="text-white/70">لا توجد طلبات معلقة.</p>';
            approvedList.innerHTML = '<p class="text-white/70">لا توجد شهادات معتمدة.</p>';
        }
        
        function loadUsers() {
            db.collection('users').onSnapshot(snap => {
                const list = document.getElementById('usersList');
                list.innerHTML = '';
                snap.forEach(doc => {
                    const user = doc.data();
                    const userItem = `
                        <div class="admin-card rounded-xl p-4 text-white flex justify-between items-center">
                            <div>
                                <p class="font-semibold">${user.name}</p>
                                <p class="text-sm text-white/70">${user.email}</p>
                            </div>
                            <span class="text-xs px-2 py-1 rounded-full bg-blue-500">${user.role}</span>
                        </div>
                    `;
                    list.innerHTML += userItem;
                });
            });
        }
        
        // Initial state
        document.getElementById('loginScreen').classList.remove('hidden');
        
    </script>
    
<script>
// Authentication state listener to show/hide panels based on user role
firebase.auth().onAuthStateChanged(user => {
  if (user) {
    // Show the user's panel by default
    document.getElementById('mainWebsite').classList.remove('hidden');
    document.getElementById('loginScreen').classList.add('hidden'); // Hide login screen

    // Check for manager role
    user.getIdTokenResult()
      .then(idTokenResult => {
        if (idTokenResult.claims.role === 'manager') {
          // If manager, hide user panel and show admin panel
          document.getElementById('mainWebsite').classList.add('hidden');
          document.getElementById('adminPanel').classList.remove('hidden');
        } else {
          // If not manager, hide admin panel
          document.getElementById('adminPanel').classList.add('hidden');
        }
      })
      .catch(err => console.error('Error fetching token:', err));

  } else {
    // User is signed out, hide all panels and show the login screen
    document.getElementById('loginScreen').classList.remove('hidden');
    document.getElementById('mainWebsite').classList.add('hidden');
    document.getElementById('adminPanel').classList.add('hidden');
  }
});
</script>
</body>
</html>
